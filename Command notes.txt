Command commands:
ls - lists all my directories
cd - change directory, type this and then the directory to get into
cd .. - go back out of a directory
cp - copy, type cp /to/file /from
pwd - print working directory

ashley@wheelerlab3:~/Scripts$ == /home/ashley/Scripts

In home, directories: 
	Plinkfiles, R, Scripts
In Plinkfiles: 
	MESA_all_merged, MESA_all_autosome files
In Scripts:
	affy_2_rsid.py

Plink commands:
call file with: --bfile directory_file_located_in(if necessary)/file_name
	--bfile consists of --bed, --bim, and --fam
end commands with --out directory_output_files_to_go_in/file_name
	this creates the output, which is a new file or files
--make-bed: makes new bed/bim/fam files

R Studio Set Up:
	install.packages("dplyr")
	install.packages("tidyr")
	install.packages("ggplot2")
	install.packages("data.table")
	library(dplyr)
	library(tidyr)
	library(ggplot2)
	library(data.table)
	"%&%" = function(a,b) paste(a,b,sep="")
	my.dir = "/home/ashley/PLinkfiles/"

### Steps taken to refine the data set

#1 changed affymatrix id to rsid
	in python script in directory: /home/ashley/Scripts
	cp ex: cp /home/lauren/scripts/affy_2_rsid.py /home/ashley/Scripts

#2 got rid of nonautosomal chromosome data and unspecificed chromosome data
	use --autosome in plink

#3 identified missings with --missing in plink

#4 created new bfiles with --geno 0.01 and --make-bed to create files with 99% (of something I dont remember) in plink

#5 calculated HWE Statistics with --hardy in plink

#6 Pruned data with --indep-pairwise 50 5 0.3 in plink

#7 Relationship check with --extract, followed by --genome --min 0.05 in plink

#8 Switch to R 
	Assign variable: lmiss <- fread(my.dir %&% "MESA_all_merged_1.lmiss")
	Create histogram: hist(lmiss$F_MISS)
	
#9 Make GGplot comparing Z0 and Z1 relationship: 
	ibd <-read.table(my.dir%&%"MESA_all_merged_autosome.geno0.01.LD3.0.05.genome",header=T)
	png(filename="mesa_all_ibd.png",res=100)
	ggplot(data=ibd,aes(x=Z0,y=Z1))+geom_point(alpha=0.25)+theme_bw()
	dev.off()
	
#10 Back in Plink: Separate Populations
	plink --bfile MESA_all_merged_autosome.geno0.01 --keep afa_samples.txt --make-bed --out MESA_AFA_merged_autosome.geno0.01
	plink --bfile MESA_all_merged_autosome.geno0.01 --keep his_samples.txt --make-bed --out MESA_HIS_merged_autosome.geno0.01
	plink --bfile MESA_all_merged_autosome.geno0.01 --keep cau_samples.txt --make-bed --out MESA_CAU_merged_autosome.geno0.01

#11 Pruned data for individual populaitons with --indep-pairwise 50 5 0.3 in plink

#12 Relationship Check for individual populations with --extract, followed by --genome --min 0.05 in plink

#13 Check Heterozygosity with --het in plink 

#14 Switch to R: 
Create Histogram for individual populations:
	afa_het<-read.table(my.dir %&% "MESA_AFA_merged_autosome.geno0.01.het", header = T)
	hist(afa_het$F,50)
	summary(afa_het$F)
	
Create GGplot for individual populations: 
	sortHET_afa<-afa_het[order(afa_het$F),]
	outliers_afa<-data.frame()
	for(i in 1:length(sortHET_afa$F)){
		if(sortHET_afa[i,6] > (mean(sortHET_afa$F)+3*sd(sortHET_afa$F))){
			outliers <- rbind(outliers,sortHET_afa[i,])
		}
		if(sortHET_afa[i,6] < (mean(sortHET_afa$F)-3*sd(sortHET_afa$F))){
			outliers <- rbind(outliers,sortHET_afa[i,])
		}
	}
	hetoutliers_afa <- select(outliers_afa,FID,IID)
	dim(hetoutliers)
	write.table(hetoutliers_afa,file=my.dir %&% "afa_3sd.txt",quote=F,col.names=F,row.names=F)

	

	

	
